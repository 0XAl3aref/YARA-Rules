{
  "result": "OK",
  "data": {
    "documents": {
      "KITPLOIT:4557506701416080186": {
        "id": "KITPLOIT:4557506701416080186",
        "vendorId": null,
        "type": "kitploit",
        "bulletinFamily": "tools",
        "title": "yarGen - A Generator for Yara Rules (for malware researchers)",
        "description": "![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgUeDU80_2j5FBzGOR-M7XHbsoblDygq-gGriBOvySfDpEoITolHez_KAlx6vYsa2AFZ7F82eUzxoQLrzeMLAzro5XdGEG3QDREpHWGH73K2nOm2eVoqcrsMdPCy3rkSvhGYlgJw81MCpA/s640/yarGen.png)\n\n  \nyarGen is a generator for Yara rules.  \n  \n**What does yarGen do?**  \n  \n\n\nThe main principle is the creation of yara rules from strings found in malware files while removing all strings that also appear in goodware files. \n\n  \n\n\nSince version 0.14.0 it uses naive-bayes-classifier by Mustafa Atik and Nejdet Yucesoy in order to classify the string and detect useful words instead of compression/encryption garbage.\n\n  \n\n\nSince version 0.12.0 yarGen does not completely remove the goodware strings from the analysis process but includes them with a very low score. The rules will be included if no better strings can be found and marked with a comment /* Goodware rule */. Force yarGen to remvoe all goodware strings with --excludegood. Also since version 0.12.0 yarGen allows to place the \"strings.xml\" from PEstudio in the program directory in order to apply the blacklist definition during the string analysis process. You'll get better results.\n\n  \n\n\nThe rule generation process tries to identify similarities between the files that get analyzed and then combines the strings to so called \"super rules\". Up to now the super rule generation does not remove the simple rule for the files that have been combined in a single super rule. This means that there is some redundancy when super rules are created. You can supress a simple rule for a file that was already covered by super rule by using --nosimple.\n\n  \n**Installation**  \n\n\n  1. Make sure you have at least 2GB of RAM on the machine you plan to use yarGen\n  2. Clone the git repository\n  3. Install all dependancies with `sudo pip install pickle scandir lxml naiveBayesClassifier`\n  4. Unzip the goodware database (e.g. `7z x good-strings.db.zip.001`)\n  5. See help with `python yarGen.py --help`\n\n  \n**Memory Requirements**  \n  \nWarning: yarGen pulls the whole goodstring database to memory and uses up to 2 GB of memory for a few seconds.   \n  \n**Command Line Parameters**  \n  \n\n    \n    \n    usage: yarGen.py [-h] [-m M] [-g G] [-u] [-c] [-o output_rule_file]\n                     [-p prefix] [-a author] [-r ref] [-l min-size] [-z min-score]\n                     [-s max-size] [-rc maxstrings] [-nr] [-oe] [-fs size-in-MB]\n                     [--score] [--inverse] [--nodirname] [--noscorefilter]\n                     [--excludegood] [--nosimple] [--nomagic] [--nofilesize]\n                     [-fm FM] [--noglobal] [--nosuper] [--debug]\n    \n    yarGen\n    \n    optional arguments:\n      -h, --help           show this help message and exit\n      -m M                 Path to scan for malware\n      -g G                 Path to scan for goodware (dont use the database\n                           shipped with yaraGen)\n      -u                   Update local goodware database (use with -g)\n      -c                   Create new local goodware database (use with -g)\n      -o output_rule_file  Output rule file\n      -p prefix            Prefix for the rule description\n      -a author            Author Name\n      -r ref               Reference\n      -l min-size          Minimum string length to consider (default=8)\n      -z min-score         Minimum score to consider (default=5)\n      -s max-size          Maximum length to consider (default=128)\n      -rc maxstrings       Maximum number of strings per rule (default=20,\n                           intelligent filtering will be applied)\n      -nr                  Do not recursively scan directories\n      -oe                  Only scan executable extensions EXE, DLL, ASP, JSP,\n                           PHP, BIN, INFECTED\n      -fs size-in-MB       Max file size in MB to analyze (default=3)\n      --score              Show the string scores as comments in the rules\n      --inverse            Show the string scores as comments in the rules\n      --nodirname          Don't use the folder name variable in inverse rules\n      --noscorefilter      Don't filter strings based on score (default in\n                           'inverse' mode)\n      --excludegood        Force the exclude all goodware strings\n      --nosimple           Skip simple rule creation for files included in super\n                           rules\n      --nomagic            Don't include the magic header condition statement\n      --nofilesize         Don't include the filesize condition statement\n      -fm FM               Multiplier for the maximum 'filesize' condition\n                           (default: 5)\n      --noglobal           Don't create global rules\n      --nosuper            Don't try to create super rules that match against\n                           various files\n      --debug              Debug output\n    \n\n  \n**Best Practice**  \n  \nSee the following blog post for a more detailed description on how to use yarGen for YARA rule creation: How to Write Simple but Sound Yara Rules  \n  \n**Examples**  \n  \n**Use the shipped database (FAST) to create some rules**  \n\n    \n    \n    python yarGen.py -m X:\\MAL\\Case1401\n\n  \nUse the shipped database of goodware strings and scan the malware directory \"X:\\MAL\" recursively. Create rules for all files included in this directory and below. A file named 'yargen_rules.yar' will be generated in the current directory.   \n  \n**Show the score of the strings as comment**  \n  \nyarGen will by default use the top 20 strings based on their score. To see how a certain string in the rule scored, use the \"--score\" parameter.  \n\n    \n    \n    python yarGen.py --score -m X:\\MAL\\Case1401\n\n  \n**Use only strings with a certain minimum score**  \n  \nIn order to use only strings for your rules that match a certain minimum score use the \"-z\" parameter. It is a good pratice to first create rules with \"--score\" and than perform a second run with a minimum score set for you sample set via \"-z\".   \n\n    \n    \n    python yarGen.py --score -z 5 -m X:\\MAL\\Case1401\n\n  \n**Preset author and reference**  \n\n    \n    \n    python yarGen.py -a \"Florian Roth\" -r \"http://goo.gl/c2qgFx\" -m /opt/mal/case_441 -o case441.yar\n\n  \n**Exclude strings from Goodware samples**  \n\n    \n    \n    python yarGen.py --excludegood -m /opt/mal/case_441\n\n  \n**Supress simple rule if alreay covered by a super rules**  \n\n    \n    \n    python yarGen.py --nosimple -m /opt/mal/case_441\n\n  \n**Show debugging output**  \n\n    \n    \n    python yarGen.py --debug -m /opt/mal/case_441\n\n  \n**Create a new goodware strings database**  \n\n    \n    \n    python yarGen.py -c -g C:\\Windows\\System32\n\n  \n**Update the goodware strings database (append new strings to the old ones)**  \n\n    \n    \n    python yarGen.py -u -g \"C:\\Program Files\"\n\n  \n**Inverse rule creation (still beta)**  \n  \nIn order to create some inverse rules on goodware, you have to prepare a directory with subdirectories in which you include all versions of the files you want to create inverse rules for with their original name and in their original folder. If that sounds strange, let me give you an example.   \nE.g. you want to create inverse rules for all Windows executables in the System32 folder, you have to create a goodware archive with the following directory structure:  \n\n\n  * G:\\goodware \n    * WindowsXP \n      * System32 - all files\n    * Windows2003 \n      * System32 - all files\n    * Windows2008R2 \n      * System32 - all files\n\nyarGen than creates rules that identify e.g. file name \"cmd.exe\" in path ending with \"System32\" and checks if the file contains certain necessary strings. If the strings don't show up, the rule will fire. This indicates a replaced system file or malware file that tries to masquerade as a system file.   \n\n    \n    \n    python yarGen.py --inverse -oe -m G:\\goodware\\\n\n  \nYou can also instruct yarGen not to include the file path but solely rely on the filename.  \n\n    \n    \n    python yarGen.py --inverse -oe --nodirname -m G:\\goodware\\\n\n  \n  \n\n\n**Download yarGen**\n",
        "published": "2015-07-16T23:33:00",
        "modified": "2015-07-16T23:33:29",
        "epss": [],
        "cvss": {
          "score": 0.0,
          "severity": "NONE",
          "version": "NONE",
          "vector": "NONE"
        },
        "metrics": {},
        "cvss2": {},
        "cvss3": {},
        "href": "http://www.kitploit.com/2015/07/yargen-generator-for-yara-rules-for.html",
        "reporter": "KitPloit",
        "references": [
          "https://github.com/Neo23x0/yarGen"
        ],
        "cvelist": [],
        "immutableFields": [],
        "lastseen": "2024-10-03T11:40:21",
        "viewCount": 570,
        "enchantments": {
          "dependencies": {},
          "score": {
            "value": 6.9,
            "uncertanity": 1.0,
            "vector": "NONE"
          },
          "backreferences": {},
          "exploitation": null
        },
        "toolHref": "https://github.com/Neo23x0/yarGen"
      }
    }
  }
}
